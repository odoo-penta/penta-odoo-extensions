<odoo>
    <record id="view_account_move_form_custom" model="ir.ui.view">
        <field name="name">account_move_form_custom</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_move_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='purchase_vendor_bill_id']" position="after">
                <field name="id_import" 
                    string="Guía de importación" 
                    groups="purchase.group_purchase_manager" 
                    invisible="move_type not in ('in_invoice', 'in_receipt', 'in_refund','entry')"
                    readonly="move_type == 'entry'"/>
            </xpath>
        </field>
    </record>

  <record id="account_view_move_form_inherit_lc_links" model="ir.ui.view">
    <field name="name">account.view.move.form.inherit.lc.links</field>
    <field name="model">account.move</field>
    <field name="inherit_id" ref="account.view_move_form"/>
    <field name="arch" type="xml">

      <!-- Campo técnico oculto para control de invisible del botón estadístico -->
      <xpath expr="//header" position="inside">
        <field name="has_any_landed_cost" invisible="1"/>
      </xpath>

      <!-- Botón estadístico 'Landed Costs': antes: invisible="not landed_costs_ids"
           ahora: invisible="not has_any_landed_cost" -->
      <xpath expr="//div[@name='button_box']//t[@groups='stock.group_stock_manager']/button[@name='action_view_landed_costs']" position="attributes">
        <attribute name="invisible">not has_any_landed_cost</attribute>
      </xpath>

            <xpath expr="//field[@name='invoice_line_ids']/list/field[@name='name']" position="after">
              <field name="id_import" readonly="0" options="{'no_create': True}"/>
          </xpath>

          <!-- Vista tipo form (cuando abres una línea) -->
          <xpath expr="//field[@name='line_ids']/list/field[@name='account_id']" position="after">
              <field name="id_import" readonly="0" options="{'no_create': True}"/>
          </xpath>


      <!-- Botón 'Create Landed Costs' YA EXISTE en esa misma vista.
           NO cambiamos el botón ni su nombre: solo dejamos que use landed_costs_visible,
           cuyo compute ya fue extendido para considerar líneas de LC.
           (Si lo tuvieras en otro lugar, este es el selector típico) -->
      <!--
      <xpath expr="//t[@groups='stock.group_stock_manager']/button[@name='button_create_landed_costs']" position="attributes">
        <attribute name="invisible">not landed_costs_visible</attribute>
      </xpath>
      -->
      <!-- Nota: el snippet anterior es solo de referencia. Tu vista original ya lo trae tal cual. -->

    </field>
  </record>

  <record id="view_move_line_tree_import_landed_cost" model="ir.ui.view">
    <field name="name">account.move.line.tree.import.landed.cost</field>
    <field name="model">account.move.line</field>
    <field name="inherit_id" ref="account.view_move_line_tree"/>
    <field name="arch" type="xml">
        <xpath expr="//field[@name='balance']" position="after">
            <field name="used_in_landed_cost" optional="hide"/>
        </xpath>
    </field>
</record>


  


</odoo>
