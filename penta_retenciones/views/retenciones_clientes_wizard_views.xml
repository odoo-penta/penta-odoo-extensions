<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>
        <!-- VISTA DEL WIZARD -->
        <record id="view_retencion_clientes_wizard_form" model="ir.ui.view">
            <field name="name">retencion.clientes.wizard.form</field>
            <field name="model">retencion.clientes.wizard</field>
            <field name="arch" type="xml">
                <form string="Retenciones TC">
                    <group>
                        <field name="partner_id"/>
                        <field name="date"/>
                        <field name="journal_id"/>
                        <field name="document_number"/>
                        <field name="sri_authorization"/>
                    </group>
                    <separator string="Líneas de retención"/>

                    <field name="retencion_line_ids" 
                        widget="one2many_list"
                        mode="list,form"
                        editable="bottom"      
                        create="true"          
                        delete="true"         
                    />
                    <footer>
                        <button name="action_confirm"
                                string="Confirmar"
                                type="object"
                                class="oe_highlight"/>
                        <button name="action_close"
                                string="Cerrar"
                                type="object"
                                class="btn-secondary"/>
                    </footer>
                </form>
            </field>
        </record>


        <!-- VISTA DE LAS LÍNEAS EN EL WIZARD -->
        <record id="view_retencion_clientes_wizard_line_tree" model="ir.ui.view">
            <field name="name">retencion.clientes.wizard.line.tree</field>
            <field name="model">retencion.clientes.wizard.line</field>
            <field name="arch" type="xml">
                <list string="Líneas de Retención"
                    editable="bottom" 
                    create="true" 
                    delete="true">
                    <field name="tax_id"/>
                    <!-- Suma en el pie para el campo base_amount -->
                    <field name="base_amount" sum="Total"/>
                    <!-- Suma en el pie para el campo tax_amount -->
                    <field name="tax_amount" sum="Total"/>

                    <!-- Pie de la tabla (Odoo dibuja automáticamente la fila de total si usas sum="Total") -->
                </list>
            </field>
        </record>
        <record id="view_retencion_clientes_wizard_line_form" model="ir.ui.view">
            <field name="name">retencion.clientes.wizard.line.form</field>
            <field name="model">retencion.clientes.wizard.line</field>
            <field name="arch" type="xml">
                <form string="Línea de Retención">
                    <group>
                        <field name="tax_id"/>
                        <field name="base_amount"/>
                        <field name="tax_amount"/>
                    </group>
                </form>
            </field>
        </record>

        <!-- ACCIÓN PARA ABRIR EL WIZARD EN MODO 'POPUP' (target='new') -->
        
    </data>
</odoo>
